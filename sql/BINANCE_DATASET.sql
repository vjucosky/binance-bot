USE STUDY

/*
	DROP TABLE IF EXISTS BINANCE_DATASET_AGGTRADE
	DROP TABLE IF EXISTS BINANCE_DATASET_TRADE
	DROP TABLE IF EXISTS BINANCE_DATASET_KLINE
	DROP TABLE IF EXISTS BINANCE_DATASET
*/

CREATE TABLE BINANCE_DATASET (
	ID bigint IDENTITY(1, 1) NOT NULL,

	[NAME] varchar(100) NOT NULL,
	NUMBER integer NOT NULL,
	START_TIMESTAMP bigint NOT NULL,
	END_TIMESTAMP bigint NOT NULL,
	CREATED_AT datetime NOT NULL CONSTRAINT DF__BINANCE_DATASET__CREATED_AT DEFAULT GETDATE(),

	CONSTRAINT PK__BINANCE_DATASET__ID PRIMARY KEY (ID),

	INDEX IX__BINANCE_DATASET__NAME__NUMBER ([NAME], NUMBER)
)

CREATE TABLE BINANCE_DATASET_KLINE (
	ID bigint IDENTITY(1, 1) NOT NULL,
	DATASET_ID bigint NOT NULL,

	[ROW] integer NOT NULL,
	TRADE_COUNT integer NOT NULL,
	OPEN_VALUE decimal(18, 8) NOT NULL,
	HIGH_VALUE decimal(18, 8) NOT NULL,
	LOW_VALUE decimal(18, 8) NOT NULL,
	CLOSE_VALUE decimal(18, 8) NOT NULL,
	BASE_ASSET_VOLUME decimal(18, 8) NOT NULL,
	BASE_ASSET_TAKER_BUY_VOLUME decimal(18, 8) NOT NULL,
	QUOTE_ASSET_VOLUME decimal(18, 8) NOT NULL,
	QUOTE_ASSET_TAKER_BUY_VOLUME decimal(18, 8) NOT NULL,
	OPEN_TIMESTAMP bigint NOT NULL,
	CLOSE_TIMESTAMP bigint NOT NULL,
	CREATED_AT datetime NOT NULL CONSTRAINT DF__BINANCE_DATASET_KLINE__CREATED_AT DEFAULT GETDATE(),

	CONSTRAINT PK__BINANCE_DATASET_KLINE__ID PRIMARY KEY (ID),
	CONSTRAINT FK__BINANCE_DATASET_KLINE__DATASET_ID FOREIGN KEY (DATASET_ID) REFERENCES BINANCE_DATASET(ID),

	INDEX IX__BINANCE_DATASET_KLINE__DATASET_ID (DATASET_ID)
)

CREATE TABLE BINANCE_DATASET_TRADE (
	ID bigint IDENTITY(1, 1) NOT NULL,
	DATASET_ID bigint NOT NULL,

	[ROW] integer NOT NULL,
	NUMBER bigint NOT NULL,
	[VALUE] decimal(18, 8) NOT NULL,
	ASSET_QUANTITY decimal(18, 8) NOT NULL,
	ASSET_PRICE decimal(18, 8) NOT NULL,
	IS_BUYER_MAKER bit NOT NULL,
	IS_BEST_MATCH bit NOT NULL,
	EXECUTION_TIMESTAMP bigint NOT NULL,
	CREATED_AT datetime NOT NULL CONSTRAINT DF__BINANCE_DATASET_TRADE__CREATED_AT DEFAULT GETDATE(),

	CONSTRAINT PK__BINANCE_DATASET_TRADE__ID PRIMARY KEY (ID),
	CONSTRAINT FK__BINANCE_DATASET_TRADE__DATASET_ID FOREIGN KEY (DATASET_ID) REFERENCES BINANCE_DATASET(ID),

	INDEX IX__BINANCE_DATASET_TRADE__DATASET_ID (DATASET_ID)
)

CREATE TABLE BINANCE_DATASET_AGGTRADE (
	ID bigint IDENTITY(1, 1) NOT NULL,
	DATASET_ID bigint NOT NULL,

	[ROW] integer NOT NULL,
	NUMBER bigint NOT NULL,
	FIRST_TRADE_NUMBER bigint NOT NULL,
	LAST_TRADE_NUMBER bigint NOT NULL,
	ASSET_QUANTITY decimal(18, 8) NOT NULL,
	ASSET_PRICE decimal(18, 8) NOT NULL,
	IS_BUYER_MAKER bit NOT NULL,
	IS_BEST_MATCH bit NOT NULL,
	EXECUTION_TIMESTAMP bigint NOT NULL,
	CREATED_AT datetime NOT NULL CONSTRAINT DF__BINANCE_DATASET_AGGTRADE__CREATED_AT DEFAULT GETDATE(),

	CONSTRAINT PK__BINANCE_DATASET_AGGTRADE__ID PRIMARY KEY (ID),
	CONSTRAINT FK__BINANCE_DATASET_AGGTRADE__DATASET_ID FOREIGN KEY (DATASET_ID) REFERENCES BINANCE_DATASET(ID),

	INDEX IX__BINANCE_DATASET_AGGTRADE__DATASET_ID (DATASET_ID)
)
